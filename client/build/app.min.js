"user strict";angular.module("chatApp",["ngRoute"]).config(["$routeProvider",function(o){o.when("/login",{templateUrl:"src/login/login.html",controller:"LoginController"}).when("/roomlist/:user",{templateUrl:"src/roomlist/roomlist.html",controller:"RoomlistController"}).when("/room/:user/:room",{templateUrl:"src/room/room.html",controller:"RoomController"}).otherwise({redirectTo:"/login"})}]);
angular.module("chatApp").controller("LoginController",["$scope","socket","$location","$rootScope","$routeParams",function(e,o,r,s,a){e.user="",e.errorMessage="",e.onLogin=function(){""===e.user?e.errorMessage="You have to choose a name before you continue!":o.emit("adduser",e.user,function(o,s){o?r.path("/roomlist/"+e.user):e.errorMessage="This username is already taken!"})}}]);
angular.module("chatApp").controller("RoomController",["$scope","socket","$location","$routeParams",function(o,e,r,n){o.message="",o.roomName=n.room,o.currUser=n.user,o.messageHistory=[],o.currUsers=[],e.emit("joinroom",{room:o.roomName}),e.on("updateusers",function(r,n,s){e.emit("users"),e.emit("rooms"),e.emit("getUserChannels"),r==o.roomName&&(o.currUsers=n)}),e.on("updatechat",function(e,r){e==o.roomName&&(o.messageHistory=r)}),o.sendmsg=function(){e.emit("sendmsg",{roomName:o.roomName,msg:o.message}),o.message=null},o.leaveRoom=function(){e.emit("partroom",o.roomName),r.path("/roomlist/"+o.currUser)},o.kickUser=function(r){r===o.currUser?console.log("kicking myself"):e.emit("kick",{user:r,room:o.roomName},function(o){o?console.log(r+" has been kicked out!"):console.log(r+" has NOT been kicked out")})},e.on("kicked",function(e,n,s){o.roomName===e&&o.currUser===n&&r.path("/roomlist/"+o.currUser+"/")}),o.banUser=function(r){r===o.currUser?console.log("ban myself"):e.emit("ban",{user:r,room:o.roomName},function(e){e?console.log(r+" has been banned from "+o.roomName):console.log(r+" has NOT been banned!")})},e.on("banned",function(e,n,s){o.roomName===e&&o.currUser===n&&r.path("/roomlist/"+o.currUser+"/")}),o.logOut=function(){e.emit("disconnectNow"),r.path("/login")}}]);
angular.module("chatApp").controller("RoomlistController",["$scope","socket","$location","$routeParams",function(o,e,r,n){o.errorMessage="",o.roomName="",o.currentUser=n.user,e.emit("users"),e.on("userlist",function(e){o.activeUsers=e}),e.emit("rooms"),e.on("roomlist",function(e){o.roomlist=e}),o.newRoom=function(){""===o.roomName?o.errorMessage="You have to choose a room name before you continue!":e.emit("joinroom",{room:o.roomName})},o.moveToRoom=function(n){e.emit("joinroom",{room:n},function(e){e?r.path("/room/"+o.currentUser+"/"+n):o.errorMessage="Cannot join room"})},o.logOut=function(){e.emit("disconnectNow"),r.path("/login")}}]);
angular.module("chatApp").factory("socket",["$rootScope",function(n){var t=io.connect("http://localhost:8080");return{on:function(o,a){t.on(o,function(){var o=arguments;n.$apply(function(){a.apply(t,o)})})},emit:function(o,a,c){t.emit(o,a,function(){var o=arguments;n.$apply(function(){c&&c.apply(t,o)})})}}}]);